<!DOCTYPE html>
<html>
<!-- Created by GNU Texinfo 7.0.2, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- 
This manual is for GNU tar (version
1.34, 4 February 2021), which creates and extracts files
from archives.

Copyright Â© 1992, 1994-1997, 1999-2001, 2003-2017, 2021
Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "GNU General Public License", with the
Front-Cover Texts being "A GNU Manual", and with the Back-Cover Texts
as in (a) below.  A copy of the license is included in the section
entitled "GNU Free Documentation License".

(a) The FSF's Back-Cover Text is: "You have the freedom to
copy and modify this GNU manual." -->
<title>Live untrusted data (GNU tar 1.34)</title>

<meta name="description" content="Live untrusted data (GNU tar 1.34)">
<meta name="keywords" content="Live untrusted data (GNU tar 1.34)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Index-of-Command-Line-Options.html" rel="index" title="Index of Command Line Options">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Security.html" rel="up" title="Security">
<link href="Security-rules-of-thumb.html" rel="next" title="Security rules of thumb">
<link href="Integrity.html" rel="prev" title="Integrity">


</head>

<body lang="en">
<div class="subsection-level-extent" id="Live-untrusted-data">
<div class="nav-panel">
<p>
Next: <a href="Security-rules-of-thumb.html" accesskey="n" rel="next">Security Rules of Thumb</a>, Previous: <a href="Integrity.html" accesskey="p" rel="prev">Integrity</a>, Up: <a href="Security.html" accesskey="u" rel="up">Security</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index-of-Command-Line-Options.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<h4 class="subsection" id="Dealing-with-Live-Untrusted-Data">10.2.3 Dealing with Live Untrusted Data</h4>

<p>Extra care is required when creating from or extracting into a file
system that is accessible to untrusted users.  For example, superusers
who invoke <code class="command">tar</code> must be wary about its actions being hijacked
by an adversary who is reading or writing the file system at the same
time that <code class="command">tar</code> is operating.
</p>
<p>When creating an archive from a live file system, <code class="command">tar</code> is
vulnerable to denial-of-service attacks.  For example, an adversarial
user could create the illusion of an indefinitely-deep directory
hierarchy <samp class="file">d/e/f/g/...</samp> by creating directories one step ahead of
<code class="command">tar</code>, or the illusion of an indefinitely-long file by
creating a sparse file but arranging for blocks to be allocated just
before <code class="command">tar</code> reads them.  There is no easy way for
<code class="command">tar</code> to distinguish these scenarios from legitimate uses, so
you may need to monitor <code class="command">tar</code>, just as you&rsquo;d need to monitor
any other system service, to detect such attacks.
</p>
<p>While a superuser is extracting from an archive into a live file
system, an untrusted user might replace a directory with a symbolic
link, in hopes that <code class="command">tar</code> will follow the symbolic link and
extract data into files that the untrusted user does not have access
to.  Even if the archive was generated by the superuser, it may
contain a file such as <samp class="file">d/etc/passwd</samp> that the untrusted user
earlier created in order to break in; if the untrusted user replaces
the directory <samp class="file">d/etc</samp> with a symbolic link to <samp class="file">/etc</samp> while
<code class="command">tar</code> is running, <code class="command">tar</code> will overwrite
<samp class="file">/etc/passwd</samp>.  This attack can be prevented by extracting into a
directory that is inaccessible to untrusted users.
</p>
<p>Similar attacks via symbolic links are also possible when creating an
archive, if the untrusted user can modify an ancestor of a top-level
argument of <code class="command">tar</code>.  For example, an untrusted user that can
modify <samp class="file">/home/eve</samp> can hijack a running instance of &lsquo;<samp class="samp">tar -cf
- /home/eve/Documents/yesterday</samp>&rsquo; by replacing
<samp class="file">/home/eve/Documents</samp> with a symbolic link to some other
location.  Attacks like these can be prevented by making sure that
untrusted users cannot modify any files that are top-level arguments
to <code class="command">tar</code>, or any ancestor directories of these files.
</p>
</div>
<hr>
<div class="nav-panel">
<p>
Next: <a href="Security-rules-of-thumb.html">Security Rules of Thumb</a>, Previous: <a href="Integrity.html">Integrity</a>, Up: <a href="Security.html">Security</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index-of-Command-Line-Options.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
